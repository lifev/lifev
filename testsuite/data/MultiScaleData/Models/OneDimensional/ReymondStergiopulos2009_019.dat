# -*- getpot -*- GetPot mode activation for emacs
###################################################################################################
#
#                       This file is part of the LifeV Applications                        
#                                 Copyright (C) 2010 EPFL          
#
#      Author(s): Cristiano Malossi <cristiano.malossi@epfl.ch>
#           Date: 2010-09-08
#  License Terms: GNU GPL
#
###################################################################################################
### MODEL: Reymond Stergiopulos 1D Arterial Tree ##################################################
###################################################################################################

[MultiScale]
modelName            = '1D ReymondStergiopulos 19 (subclavian A left)'
modelType            = OneDimensional
couplingFlags        = '0 1'



[exporter]
start                = 0             # start index for filenames
save                 = 1             # how many time steps per posptrocessing
multimesh            = false         # true if the mesh has to be saved at each post-processing step



[1D_Model]

[./Model]
PhysicsType          = OneD_NonLinearPhysics
FluxType             = OneD_NonLinearFlux
SourceType           = OneD_NonLinearSource

[../PhysicalParameters]
ComputeCoefficients  = true
PowerlawCoefficient  = 9            # 2: Parabolic; 9: Typical value

#DistributionLaw      = pointwise              # Coefficients distribution law: none, linear, pointwise
DistributionLaw      = linear              # Coefficients distribution law: none, linear, pointwise

#Area0                = '0.9503317777 0.9503317777 0.9503317777 0.939071 0.927809 0.916548 0.905287 0.894026 0.882764 0.871503 0.860242 0.848981 0.83772 0.826458 0.815197 0.803936 0.792675 0.781413 0.770152 0.758891 0.74763 0.736369 0.725107 0.713846 0.702585 0.691324 0.680062 0.668801 0.65754 0.646279 0.635018 0.623756 0.612495 0.601234 0.589973 0.578711 0.5674501731 0.5674501731 0.5674501731' # Strong tapering
#Area0                = '0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.939071 0.927809 0.916548 0.905287 0.894026 0.882764 0.871503 0.860242 0.848981 0.83772 0.826458 0.815197 0.803936 0.792675 0.781413 0.770152 0.758891 0.74763 0.736369 0.725107 0.713846 0.702585 0.691324 0.680062 0.668801 0.65754 0.646279 0.635018 0.623756 0.612495 0.601234 0.589973 0.578711 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731' # Strong tapering
#Area0                = '0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.9503317777 0.949515124987451 0.947072134242804 0.943023648201718 0.937404207119639 0.930261754086522 0.921657225993285 0.911664033639751 0.900367435419577 0.887863809925712 0.874259833682214 0.859671571017765 0.844223483845743 0.828047369799057 0.811281237779216 0.794068130513042 0.776554904162559 0.758890975400000 0.741227046637441 0.723713820286958 0.706500713020783 0.689734581000943 0.673558466954257 0.658110379782235 0.643522117117786 0.629918140874288 0.617414515380423 0.606117917160249 0.596124724806715 0.587520196713478 0.580377743680361 0.574758302598282 0.570709816557196 0.568266825812549 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731 0.5674501731' # Long smooth tapering sin(x)^2
#Area0                = '0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.950331777700000 0.949107452056657 0.945452733882036 0.939422060400791 0.931105036660849 0.920624772595047 0.908135599565433 0.893820210019156 0.877886274902331 0.860562603448109 0.842094918686304 0.822741329346942 0.802767584608648 0.782442202264119 0.762031563260097 0.741795066172605 0.721980433988259 0.702819262602123 0.684522895768692 0.667278704944913 0.651246844663501 0.636557544920928 0.623308991732922 0.611565835699372 0.601358356347213 0.592682297415696 0.585499375355325 0.579738450376936 0.575297336659036 0.572045216043818 0.569825607960681 0.568459837632999 0.567750935054231 0.567487888946778 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000 0.567450173100000' # Long smooth tapering sin(x)^3
Area0                = '0.9503317777 0.5674501731' # Area of tube
#Area0                = '0.7466191291 0.7466191291' # Area of tube - averaged

thickVessel          = false
#thickness            = '0.055 0.055 0.055 0.0546324 0.0542647 0.0538971 0.0535294 0.0531618 0.0527941 0.0524265 0.0520588 0.0516912 0.0513235 0.0509559 0.0505882 0.0502206 0.0498529 0.0494853 0.0491176 0.04875 0.0483824 0.0480147 0.0476471 0.0472794 0.0469118 0.0465441 0.0461765 0.0458088 0.0454412 0.0450735 0.0447059 0.0443382 0.0439706 0.0436029 0.0432353 0.0428676 0.0425 0.0425 0.0425' # Long strong tapering
#thickness            = '0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.0546324 0.0542647 0.0538971 0.0535294 0.0531618 0.0527941 0.0524265 0.0520588 0.0516912 0.0513235 0.0509559 0.0505882 0.0502206 0.0498529 0.0494853 0.0491176 0.04875 0.0483824 0.0480147 0.0476471 0.0472794 0.0469118 0.0465441 0.0461765 0.0458088 0.0454412 0.0450735 0.0447059 0.0443382 0.0439706 0.0436029 0.0432353 0.0428676 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425' # Long strong tapering
#thickness            = '0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.055 0.054973338601844 0.054893581873024 0.054761410269830 0.054577951433777 0.054344770570969 0.054063857098310 0.053737607670502 0.053368805732629 0.052960597772791 0.052516466477370 0.052040201017983 0.051535864723603 0.051007760413670 0.050460393687951 0.049898434486354 0.049326677246646 0.048750000000000 0.048173322753354 0.047601565513646 0.047039606312049 0.046492239586330 0.045964135276397 0.045459798982017 0.044983533522630 0.044539402227209 0.044131194267371 0.043762392329499 0.043436142901690 0.043155229429031 0.042922048566223 0.042738589730170 0.042606418126976 0.042526661398156 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425 0.0425' # Long smooth tapering sin(x)^2
#thickness            = '0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.055000000000000 0.054973338601844 0.054893581873024 0.054761410269830 0.054577951433777 0.054344770570969 0.054063857098310 0.053737607670502 0.053368805732629 0.052960597772791 0.052516466477370 0.052040201017983 0.051535864723603 0.051007760413670 0.050460393687951 0.049898434486354 0.049326677246646 0.048750000000000 0.048173322753354 0.047601565513646 0.047039606312049 0.046492239586330 0.045964135276397 0.045459798982017 0.044983533522630 0.044539402227209 0.044131194267371 0.043762392329499 0.043436142901690 0.043155229429031 0.042922048566223 0.042738589730170 0.042606418126976 0.042526661398156 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000 0.042500000000000' # Long smooth tapering sin(x)^3
thickness            = '0.0550000000 0.0425000000' # Thickness of tube
#thickness            = '0.0487500000 0.0487500000' # Thickness of tube - averaged

# Avolio elastin
young                = 4.0E6 # g/cm/s^2 (dyne/cm^2)
poisson              = 0.0

[../space_discretization]
#Length               = 13.4
#NumberOfElements     = 134          # number of elements

Length               = 3.4
NumberOfElements     = 34          # number of elements

[../JacobianPerturbation]
deltaArea            = 0.01         # perturbation on the area
deltaFlowRate        = 0.01         # perturbation on the flow rate
deltaPressure        = 10           # perturbation on the pressure

[../miscellaneous]
post_dir             = ./           # the directory for postprocessing files
post_file            = sol          # the file name
verbose              = 1
CFLmax               = 0.5          # Maximum admissible value of the CFL 

[../solver]

    [./amesos]
    solvertype            = Umfpack
    
    outputlevel           = 0
    print_status          = false
    print_timing          = false
    computevectornorms    = false
    computeresidual       = false
    
    addzerotodiag         = false
    refactorize           = false
    rcondthreshold        = 1e-2
    redistribute          = true
    maxprocs              = -1
    matrixproperty        = general
    scalemethod           = 1
    
    [../]
 